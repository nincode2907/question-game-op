import e from"./questions.js";const t=document.querySelectorAll(".fruit"),n=document.querySelector(".questionSection"),s=document.querySelector(".time_count"),i=document.querySelectorAll(".list_item"),o=document.querySelectorAll(".list_item_nameTeam"),r=document.querySelector(".rank_heading"),c=document.querySelector(".addPoint"),l=document.querySelector(".devilFruit"),a=document.querySelector(".time"),u=[],d=[],m=[60,88,116,144];var p,_="",q=0,y=0,S=!1,f=!1;function L(){Array.from(i).sort(((e,t)=>{const n=parseInt(e.querySelector(".list_item_point").innerHTML);return parseInt(t.querySelector(".list_item_point").innerHTML)-n})).forEach(((e,t)=>{e.style.top=m[t]+"px"}))}async function g(e){return new Promise((t=>setTimeout(t,e)))}function T(){d.length==i.length&&(d.length=0);do{y=Math.floor(Math.random()*i.length)}while(d.includes(y));if(d.push(y),f)return document.querySelector(".rank").classList.add("fill_screen"),localStorage.setItem("winner",_),setTimeout((()=>{document.querySelector(".fill").classList.add("filled")}),5e3),void setTimeout((()=>{window.location="../../winner.html"}),9100);S=!1,async function(e){const t=a.querySelector(".time_count");for(let n=parseInt(t.innerHTML);n<=e;n++)await g(n+10),t.innerHTML=n.toString()}(45),o[y].classList.add("list_item_nameTeam--turned")}setTimeout((()=>{l.style.opacity=1}),4e3),t.forEach(((t,l)=>{t.addEventListener("click",(async l=>{if(S)return;let a;S=!0;do{a=Math.floor(Math.random()*e.length)}while(u.includes(a));if(u.push(a),u.length==e.length&&(f=!0),e[a].question.includes("lucky")||e[a].question.includes("failed")){let t="";e[a].question.includes("lucky")?(t='<div class="special">\n                            <h2 class="special_heading special_heading--lucky">lucky</h2> \n                            <img src="./assets/img/lucky.png" alt="Lucky" class="special_img">\n                        </div>',c.querySelector(".addPoint_point").innerHTML=3,i[y].querySelector(".list_item_point").innerHTML=parseInt(i[y].querySelector(".list_item_point").innerHTML)+3,parseInt(i[y].querySelector(".list_item_point").innerHTML)>q&&(q=parseInt(i[y].querySelector(".list_item_point").innerHTML),_=o[y].innerHTML)):(c.querySelector(".addPoint_point").innerHTML=0,t='<div class="special">\n                            <h2 class="special_heading special_heading--failed">failed</h2> \n                            <img src="./assets/img/failed.png" alt="Failed" class="special_img">\n                        </div>'),n.innerHTML=t,c.style.top=r.getBoundingClientRect().top-60+"px",c.style.left=r.getBoundingClientRect().left+85+"px",c.classList.add("addPoint--fade"),setTimeout((()=>{L(),c.classList.remove("addPoint--fade"),c.style.top="240px",c.style.left="calc(50% - 120px)"}),5e3),setTimeout((()=>{o[y].classList.remove("list_item_nameTeam--turned"),T()}),8500)}else{let i=`<div class="question">\n                            <h2 class="questionSection_question">\n                                <Strong class="questionSection_question_content"></Strong>\n                            </h2>\n                            <div class="questionSection_answers">\n                                <div>\n                                    <span class="questionSection_answer">\n                                        <span class="questionSection_answer_capLetter">A.</span>\n                                        <span class="questionSection_answer_content">${e[a].answers[0]}</span>\n                                    </span>\n                                    <br>\n                                    <span class="questionSection_answer">\n                                        <span class="questionSection_answer_capLetter">B.</span>\n                                        <span class="questionSection_answer_content">${e[a].answers[1]}</span>\n                                    </span>\n                                    <br>\n                                    <span class="questionSection_answer">\n                                        <span class="questionSection_answer_capLetter">C.</span>\n                                        <span class="questionSection_answer_content">${e[a].answers[2]}</span>\n                                    </span>\n                                    <br>\n                                    <span class="questionSection_answer">\n                                        <span class="questionSection_answer_capLetter">D.</span>\n                                        <span class="questionSection_answer_content">${e[a].answers[3]}</span>\n                                    </span>\n                                </div>\n                                <span class="correct_png"></span>\n                                <img src="./assets/img/person/${t.alt}.png" alt="${t.alt}" class="questionSection_answers_img">\n                            </div>\n                    </div>`;n.innerHTML=i;const o=document.querySelector(".questionSection_question_content");for(let t=1;t<=e[a].question.length;t++)await g(25),o.innerHTML=e[a].question.substring(0,t);let r=45;p=setInterval((()=>{0==r&&clearInterval(p),s.innerHTML=r--}),1e3);const c=document.querySelector(".correct_png"),l=document.querySelectorAll(".questionSection_answer_content");let u;l.forEach(((t,n)=>{t.innerHTML==e[a].correctAnswer&&(u=n)}));const d=l[u];document.querySelector(".questionSection_answers_img").addEventListener("click",(()=>{c.style.top=d.offsetParent.offsetTop-2+"px",p&&clearInterval(p),setTimeout((()=>{document.querySelector(".confirm").classList.add("confirm--show")}),5e3)}))}setTimeout((()=>{t.classList.add("fruitDisabled")}),3e3)}))})),a.addEventListener("click",(()=>{p&&clearInterval(p)})),document.querySelector(".confirm_btn--correct-first").onclick=()=>{document.querySelector(".confirm").classList.remove("confirm--show"),document.querySelector(".addPoint_point").innerHTML=2,c.style.top=r.getBoundingClientRect().top-60+"px",c.style.left=r.getBoundingClientRect().left+85+"px",c.classList.add("addPoint--fade"),i[y].querySelector(".list_item_point").innerHTML=parseInt(i[y].querySelector(".list_item_point").innerHTML)+2,parseInt(i[y].querySelector(".list_item_point").innerHTML)>q&&(q=parseInt(i[y].querySelector(".list_item_point").innerHTML),_=o[y].innerHTML),setTimeout((()=>{L(),c.classList.remove("addPoint--fade"),c.style.top="240px",c.style.left="calc(50% - 120px)"}),3e3),setTimeout((()=>{o[y].classList.remove("list_item_nameTeam--turned"),T()}),8500)},document.querySelector(".confirm_btn--correct-second").onclick=()=>{document.querySelector(".confirm").classList.remove("confirm--show"),document.querySelector(".addPoint_point").innerHTML=1,c.style.top=r.getBoundingClientRect().top-60+"px",c.style.left=r.getBoundingClientRect().left+85+"px",c.classList.add("addPoint--fade"),i[y].querySelector(".list_item_point").innerHTML=parseInt(i[y].querySelector(".list_item_point").innerHTML)+1,parseInt(i[y].querySelector(".list_item_point").innerHTML)>q&&(q=parseInt(i[y].querySelector(".list_item_point").innerHTML),_=o[y].innerHTML),setTimeout((()=>{L(),c.classList.remove("addPoint--fade"),c.style.top="240px",c.style.left="calc(50% - 120px)"}),3e3),setTimeout((()=>{o[y].classList.remove("list_item_nameTeam--turned"),T()}),8500)},document.querySelector(".confirm_btn--incorrect").onclick=e=>{document.querySelector(".addPoint_point").innerHTML=0,c.style.top=r.getBoundingClientRect().top-60+"px",c.style.left=r.getBoundingClientRect().left+85+"px",c.classList.add("addPoint--fade"),setTimeout((()=>{o[y].classList.remove("list_item_nameTeam--turned"),T(),c.classList.remove("addPoint--fade"),c.style.top="240px",c.style.left="calc(50% - 120px)"}),8500),document.querySelector(".confirm").classList.remove("confirm--show")},T();